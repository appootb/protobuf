// Code generated by protoc-gen-auth. DO NOT EDIT!
// source: account.proto
package account

import (
	"context"

	"github.com/appootb/protobuf/go/common"
	"github.com/appootb/protobuf/go/permission"
	"github.com/appootb/protobuf/go/service"
	"google.golang.org/grpc"
)

// Reference imports to suppress errors if they are not otherwise used.
var _ = context.TODO()
var _ = grpc.ServiceDesc{}
var _ = permission.Subject_NONE
var _ = service.UnaryServerInterceptor

var _accountServiceSubjects = map[string][]permission.Subject{
	"/appootb.account.Account/GetInfo": {
		permission.Subject_NONE,
	},
	"/appootb.account.Account/GetInfos": {
		permission.Subject_NONE,
	},
	"/appootb.account.Account/UpdateInfo": {
		permission.Subject_PC,
		permission.Subject_MOBILE,
		permission.Subject_WEB,
	},
}

type wrapperAccountServer struct {
	AccountServer
	service.Implementor
}

func (w *wrapperAccountServer) GetInfo(ctx context.Context, req *common.UniqueId) (*Info, error) {
	if w.UnaryInterceptor() == nil {
		return w.AccountServer.GetInfo(ctx, req)
	}
	info := &grpc.UnaryServerInfo{
		Server:     w.AccountServer,
		FullMethod: "/appootb.account.Account/GetInfo",
	}
	handler := func(ctx context.Context, req interface{}) (interface{}, error) {
		return w.AccountServer.GetInfo(ctx, req.(*common.UniqueId))
	}
	resp, err := w.UnaryInterceptor()(ctx, req, info, handler)
	if err != nil {
		return nil, err
	}
	return resp.(*Info), nil
}

func (w *wrapperAccountServer) GetInfos(ctx context.Context, req *common.UniqueIds) (*Infos, error) {
	if w.UnaryInterceptor() == nil {
		return w.AccountServer.GetInfos(ctx, req)
	}
	info := &grpc.UnaryServerInfo{
		Server:     w.AccountServer,
		FullMethod: "/appootb.account.Account/GetInfos",
	}
	handler := func(ctx context.Context, req interface{}) (interface{}, error) {
		return w.AccountServer.GetInfos(ctx, req.(*common.UniqueIds))
	}
	resp, err := w.UnaryInterceptor()(ctx, req, info, handler)
	if err != nil {
		return nil, err
	}
	return resp.(*Infos), nil
}

func (w *wrapperAccountServer) UpdateInfo(ctx context.Context, req *VariableInfo) (*Info, error) {
	if w.UnaryInterceptor() == nil {
		return w.AccountServer.UpdateInfo(ctx, req)
	}
	info := &grpc.UnaryServerInfo{
		Server:     w.AccountServer,
		FullMethod: "/appootb.account.Account/UpdateInfo",
	}
	handler := func(ctx context.Context, req interface{}) (interface{}, error) {
		return w.AccountServer.UpdateInfo(ctx, req.(*VariableInfo))
	}
	resp, err := w.UnaryInterceptor()(ctx, req, info, handler)
	if err != nil {
		return nil, err
	}
	return resp.(*Info), nil
}

// Register scoped server.
func RegisterAccountScopeServer(auth service.Authenticator, impl service.Implementor, srv AccountServer) error {
	// Register service required subjects.
	auth.RegisterServiceSubjects(_accountServiceSubjects)

	// Register scoped gRPC server.
	for _, gRPC := range impl.GetGRPCServer(permission.VisibleScope_CLIENT) {
		RegisterAccountServer(gRPC, srv)
	}
	// Register scoped gateway handler server.
	wrapper := wrapperAccountServer{
		AccountServer: srv,
		Implementor:   impl,
	}
	for _, mux := range impl.GetGatewayMux(permission.VisibleScope_CLIENT) {
		err := RegisterAccountHandlerServer(impl.Context(), mux, &wrapper)
		if err != nil {
			return err
		}
	}

	return nil
}
